%!TEX root = New.tex
\chapter{Background}
\label{ch:background}
\eat{
\begin{itemize}
\item
More than a literature review
\item
Organize related work - impose structure
\item
Be clear as to how previous work being described relates to your own.
\item
The reader should not be left wondering why you've described something!!
\item
Critique the existing work - Where is it strong where is it weak? What are the unreasonable/undesirable assumptions?
\item
Identify opportunities for more research (i.e., your thesis) Are there unaddressed, or more important related topics?
\item
After reading this chapter, one should understand the motivation for and importance of your thesis
\item
You should clearly and precisely define all of the key concepts dealt with in the rest of the thesis, and teach the reader what s/he needs to know to understand the rest of the thesis.
\end{itemize}
}

This thesis builds on prior research in three areas: traffic engineering, content delivery, and the interaction of the two. We first review the major classes of traffic engineering strategies (Section \ref{sec:bg-te}). Next, we discuss common techniques used by content delivery systems, including strategies for content placement and for request  redirection (Section \ref{sec:bg-cdn}). Finally, we survey research on the interaction between network and content delivery, and find that the interaction between traffic engineering and either overlay routing or request redirection have been the focus of past research (Section \ref{sec:bg-interaction}).



\section{Traffic engineering}
\label{sec:bg-te}

The goal of traffic engineering (TE)  is to avoid congestion hotspots in the network by optimizing routes based on network topology and expected traffic demand. In the context of large Internet service provider (ISP) networks, traffic engineering decides both intra-domain (within the ISP) and inter-domain routing (across ISPs). We focus here on intra-domain routing and refer the reader to  \cite{Feamster2003,rexford} for a survey of inter-domain traffic engineering. 





We classify traffic engineering schemes based on the frequency at which they update routing. By this attribute, TE schemes can be grouped into three categories: (1) \emph{Demand-oblivious TE} uses static routes that are seldom updated \cite{Cohen,Racke}. (2) \emph{Demand-aware TE}  updates routes periodically, e.g., every few hours or every few days, based on recent history of traffic demand \cite{fortz2000internet,fortz2002traffic}. (3) \emph{Online TE} updates routes at timescales of hundreds of milliseconds, reacting instantaneously to traffic demand changes \cite{TEXCP}.

TE schemes are evaluated based on link utilization based metrics, e.g., a widely used metric is maximum link utilization \cite{COPE}. A TE scheme is usually compared against the optimal solution that minimizes the given metric by solving a multi-commodity flow optimization  \cite{TEXCP,fortz2000internet}.
By this measure, oblivious routing schemes perform poorly and can be shown to be arbitrarily worse compared to the optimal strategy  \cite{fortz2000internet}. For many ISPs networks, simple oblivious routing schemes are sub-optimal by a small constant factor  \cite{COPE,MultiTM,TEXCP}.
Offline TE schemes, while sub-optimal, perform superior to oblivious TE schemes. e.g., Fortz and Thorup show that   offline TE delivers up to 2$\times$ better on AT\&T network backbone. Online schemes have been shown to achieve near-optimal performance, but they are rarely used in production networks.

In practice, offline TE based on Open Shortest Path First (OSPF) and Multiprotocol Label Switching (MPLS) are commonly used  \cite{COPE,MultiTM,fortz2000internet,MPLS2}. Routes computed by OSPF traffic engineering must follow shortest-weight paths, therefore OSPF TE provides limited functionality to split traffic among multiple paths. 
MPLS TE overcomes this limitation by enabling traffic between two nodes to be split  in arbitrary ratios among multiple paths.
Therefore, MPLS TE gives better results than OSPF TE  \cite{COPE,MultiTM}.



Prior work on traffic engineering is based primarily on evaluation of link utilization based metrics, and has largely ignored the impact of traffic engineering on user-perceived performance. Further, the comparison of TE schemes has not taken into account the interaction with content delivery. This thesis contributes in answering these questions. In Chapter \ref{ch:beyondmlu}, we provide a comparison of traffic engineering schemes focusing on user-perceived metrics such as file download times, and VoIP call quality. In Chapter \ref{ch:beyondmlu} and Chapter \ref{ch:ncdn}, we evaluate TE schemes while accounting for the interaction between TE and content delivery and show that this interaction helps simpler TE schemes, such as oblivious TE or OSPF TE, perform closer to the optimal TE strategy in terms of user-perceived metrics as well as TE metrics.

%Server shutdown policies that concentrate traffic on the smallest possible subset of network topology indeed enable maximum network energy savings. 

%In Chapter 5, we show that server shutdown policies that concentrate traffic on the smallest possible subset of network topology indeed enable maximum network energy savings. 



%Network energy savings due to energy-aware traffic engineering depends on traffic patterns in the network, traffic patterns that are assumed to be fixed. In the case of CDN data centers, traffic patterns could be shaped by load balancing decisions and server shutdown policies. In Chapter 5, we investigate TE strategies that coordinate with datacenter load balancing decisions and server shutdown policies, and yield greater network energy savings than shown by prior work.

%We hypothesize that  there exists potential for more network energy savings in datacenters than shown previously, provided techniques for saving server energy work in coordination with those for saving network energy. 

%\textcolor{red}{How much energy could be further saved in scenarios where content placement flexibility exists?}

%The above discussion has focused more on traffic engineering in wide-area networks. Traffic engineering in data center networks is another very active research area and we refer the reader to  \cite{,,} for few recent papers.

%In comparison to approaches that optimize routing for a given traffic matrix, this paper shows that a joint optimization of content placement and routing for content-serving clusters yields greater network energy savings.

\section{Content delivery}
\label{sec:bg-cdn}
Content delivery systems seek to provide a high-quality experience to users accessing content in all regions  at all times. A canonical example of a content delivery system is a content delivery network (CDN). State-of-the-art CDNs operate geo-distributed datacenters, and use a combination of edge caching, intelligent server selection, and path and protocol optimizations for delivery of several types of content, e.g., video, bulk downloads, and interactive websites \cite{DilleyMPPSW02,akamai-overview}. Given their geo-distributed deployment, the decisions of content placement, i.e., locations at which a content is placed, and request redirection, i.e., which location is best positioned to serve a user's request, are central to the functioning of a CDN.

%The design of a content delivery system must consider the unpredictable nature of the Internet and of content workloads. The unpredictability arises from changes in network conditions, sudden spikes in content popularity, as well as malicious traffic generated by DDoS attacks. To provide quick response to these events, content delivery systems must use algorithms that are computationally efficient. Content delivery systems of today use distributed heuristics, often trading optimality for efficiency, to ensure high-quality user experience in all regions at all times.

\subsection{Content placement}
\label{sec:placement}
Placement strategies depend on whether content is static or dynamic. 
Dynamic content has limited cacheability therefore placement  strategies for static content are not always applicable for dynamic content.

\subsubsection{Static content placement}
\label{sec:static}
Static content, such as videos, audio, images and software updates, contribute to a vast majority of traffic in the Internet \cite{nielsen-video-growth,cisco-videogrowth}.  The placement of static content is commonly handled by a caching strategy. A simple and widely used caching strategy is least recently used (LRU) cache replacement  \cite{wessels2009squid}. Caching strategies are effective because they exploit geographic and temporal locality of requests, resulting in high cache hit rates in many cases  \cite{davison2001web,NCDN,gadde2001web}. 
An alternative to caching is a planned placement approach,  which prepositions content at a set of locations based on prior knowledge of demand. Planned placement is effective in scenarios where workloads are predictable over long intervals, e.g., hours, or days \cite{Applegate2010}. 



%Little attention that these placement strategies have on networks.

\subsubsection{Dynamic content placement}
\label{sec:dynamic}
Several applications today generate dynamic content such as stock prices, weather information, price catalogs. Such dynamic content is typically stored at a small number of fixed locations across the globe, mostly for fault tolerance objectives  \cite{sql-geo-replication}. Due to a limited number of fixed replica locations,  content accesses from regions away from the replica locations incurs high latency \cite{sql-geo-replication,volley}. Extensively replicating dynamic content is costly due to bandwidth and server resources used in propagating updates to  all locations. 

Placement strategies for dynamic content is an active research area. A naive placement strategy of replicating all data at all locations would incur high update costs. The alternatives provided by current systems either require manual configuration to decide placement or result in sub-optimal latency.
For example, Spanner  \cite{spanner} provides configuration options to manually select which locations should a given subset of data be replicated. 
DHT-based systems automatically decide placement but result in high latency because replica are chosen randomly \cite{beehive,codons-paper}.
Volley  \cite{volley} uses a placement heuristic to select a single best location for each data item, but it would result in sub-optimal latencies when a data item is popular across many geographic regions.

This thesis addresses the problem of dynamic data placement across geo-distributed data centers while enhancing prior work in this area (Chapter \ref{ch:auspice}). Our system, Auspice, automatically makes data placement decisions (unlike Spanner), places data replicas based on demand-locality (unlike DHT-based replication), and creates multiple replicas of each object (unlike Volley) Êand limits update propagation costs.

\subsection{Request redirection}
\label{sec:redirection}

Request redirection strategies complement placement strategies by selecting the server location that is best suited to process a user's request. These strategies have been extensively studied and form the heart of CDN technology today. To quote from a report by Akamai,  \emph{``the system directs client requests to the nearest available server likely to have the requested content."} where the ``nearest" server is one whose round trip latency as well as packet losses are small, and  an ``available" server is one that is lightly loaded considering all resources, i.e., network, CPU and disk  \cite{DilleyMPPSW02}. 

Request redirection is implemented using three processes: (1) \emph{Monitoring:} Probe messages sent intermittently help monitor network characteristics and server load and identify congested regions of network and overloaded server locations \cite{oasis,donar}. (2) \emph{Estimating distances:} The measured statistics are combined to compute a distance function that reflects the proximity of a server location to users in a geographic region \cite{donar}. (3) \emph{Informing the user:} The user is informed of selected server/s either via DNS resolution or via HTTP redirection as described in  \cite{DilleyMPPSW02} and  \cite{barbir2003known}.




% Analysis of traces within a data center has shown that servers are typically lightly loaded. 
% Motivated by this observation, several papers  \cite{mathew12,Jain,lin12,lu13}, based on trace-driven experiments,  have explored how much energy savings can be obtained by using only a fraction of the servers at a given time, and by shutting-off remaining servers or switching them to a low power state.
 


\section{Interaction between network and content delivery}
\label{sec:bg-interaction}

Studying the interaction between network and content delivery has been a topic of much interest in both systems and theory communities. Several related questions have been put forth. Do these interactions negatively affect objectives of networks and content delivery systems? What is the sub-optimality caused due to these interactions in the worst case, and for typical topologies and traffic demands? How to leverage these interactions to improve traffic engineering and content delivery objectives? 

Yet, we don't fully understand these interactions because prior research has studied the interaction of network routing with only a subset of content delivery decisions. 
Much prior research has focused on two aspects: the interaction of overlay routing and network routing  \cite{Roughgarden,selfishQiu}, and the interaction of request redirection and network routing  \cite{Jiang2009,JohariGameTheory, CATE, P4P}. While placement decisions are critical to user-perceived performance, there has been little research on how content placement interacts with network routing.

\subsection{Interaction between traffic engineering and overlay routing}
\label{sec:overlayunderlay}

Several results show the negative interaction between selfish overlay routing and network routing \cite{Roughgarden,selfishQiu}, however it appears that selfish overlay routing is not used by most of the Internet traffic. 
%Theoretical results indicate that the negative interaction could cause an arbitrary degradation in user perceived delay. Further studies using synthetic traffic demands and topologies indicate that this interaction hurt traffic engineering metrics.  
%However, it appears that a small fraction of Internet traffic uses overlay routing. 
For example, traffic from CDN edge server to the client always follows network routing. Further, overlay routing yields ``marginal" benefits ($<$ 30\%) over network routing for 79\%-96\% of paths depending on which geographic region is being considered  \cite{rahul2006overlays}, which suggests that traffic between CDN servers forming an overlay network follows network routing in most cases. For this reason, this thesis does not model the interaction between overlay and network routing.


%Despite several results regarding negative interaction of seflish overlay routing and network routing, its implications for present day Internet are not clear. Theoretical results indicate that the negative interaction could cause an arbitrary degradation in user perceived performance. Further studies using synthetic traffic demands and topologies indicate that this interaction could hurt the performance of traffic engineering schemes.  However, in today's Internet, it is not clear what fraction of traffic follows overlay routing. For example, traffic from CDN edge node to the client always follows network routing. Further, overlay routing yields "marginal" benefits (< 30%) over network routing for 79%-96% of paths depending on which geographic region is being considered. Therefore, in this thesis, we assume that all traffic is compliant to network-routing. 
%
%Traffic from CDN edge node to the client, which form a bulk of traffic always follows network routing. Similarly, traffic between overlay nodes 
%
%
%
%
%In the worst case, the negative interaction could cause an arbitrary degradation in user perceived performance; for typical networks and traffic demands, performance degradation is a small factor.
%
%
%Subject: prior studies ignore a key component of this interaction, which is the role of placement strategies. 
%
%prior work 1: overlay vs network routing
%
%results: negative effect on traffic engineering, close to optimal delay in internet-like environments. In this thesis, assuming that all traffic is network-routing compliant. 
%
%we do not consider the interaction of overlay vs network routing.
%
%prior work 2: redirection vs network routing
%
%Commonly, these efforts assume that all content is available at all locations, ignoring the fact that that content availability at a location depend on placement strategies. Therefore, placement strategies must be taken into account in studying this interaction.
%
% 
%
%Interaction between overlay routing and underlay routing does happen, but it happens only for a small fraction of traffic. Traffic from CDN edge node to the client, which form a bulk of traffic always follows network routing. Similarly, traffic between overlay nodes 
%
%While placement decisions are critical to user-perceived performance, little research in this area has focused how they interact with traffic engineering.
%


% Therefore, as a simplification, we assume that all traffic is compliant to network-routing. 


%While theoretical results indicate that the negative interaction could cause an arbitrary degradation in user perceived performance. In the worst case, the negative interaction could cause an arbitrary degradation in user perceived performance; for typical networks and traffic demands, performance degradation is a small factor.While traffic engineering selects a set of physical links to route traffic, overlay routing selects a path consisting of a sequence of intermediate  overlay nodes on way to the destination.  Overlay routing negatively interacts with traffic engineering if all flows are  allowed to selfishly choose overlay routes. In the worst case, the negative interaction could cause an arbitrary degradation in user perceived performance; for typical networks and traffic demands, performance degradation is a small factor. However, a network layer routing that is very inefficient could benefit from an overlay routing, if overlay routes in a coordinated fashion. Therefore, negative interactions between overlay routing and traffic engineering happen, but not always.


\subsection{Interaction between traffic engineering and request redirection}
\label{sec:jointopt}

Recent research has investigated the interaction between request redirection and traffic engineering, without considering the role of placement strategies. This interaction is commonly studied in the context of Internet service providers (ISPs) and content providers (CPs) with geo-distributed datacenters. 
Both analytical results \cite{Jiang2009,JohariGameTheory} and system implementations \cite{CATE,P4P} have shown that there is value for joint optimization of request redirection and traffic engineering, and cooperative strategies can help traffic engineering metrics and also reduce user-perceived latencies. Commonly, these efforts assume that all content is available at all locations, ignoring the fact that content availability at a location depend on placement strategies. Therefore, in this thesis, we account for the effect of content placement along with request redirection, in studying the interaction between network and content delivery.

\section{Summary}
\label{sec:summary}
In this chapter, we reviewed prior research on traffic engineering and summarized different classes of traffic engineering schemes. We also reviewed common techniques used for content delivery, namely strategies for placement of static content and of dynamic content, and request redirection techniques used by CDNs. Finally, we reviewed research on interaction between network and content delivery, and found that much prior research in this area has focused on two aspects, the interaction of overlay routing and network routing, and the interaction of request redirection and network routing.

\eat{Our survey of work in traffic engineering, content delivery and interactions between them has shown the following directions for research, which we pursue in this thesis: (1) how does content placement strategy shape the interaction between network and content delivery, and how it affects the performance and cost metrics of networks and content delivery systems? (2) how do we design a system for placing dynamic objects across geo-distributed data centers, while minimizing request latencies, limiting resource cost of update propagation, and providing desired consistency guarantees?}


\eat{
Traffic engineering is the process by which network operators select routes for avoid congestion hotspots in the network. We can categorize TE schemes into oblivious, offline, and online. Commonly, offline TE schemes using either OSPF or MPLS are widely used in ISP networks.

Content delivery depends on two key decisions of content placement and request redirection. Placement for static content is done by CDNs using cache replacement policies such as least recently used (LRU). Placement of dynamic content is done via fixed placement policies, such as k-random, which results in a sub-optimal latency. Request redirection strategies complement placement strategies in optimizing user-perceived performance by directing a user to the best positioned server based on network latency, path loss rates, and load on the server. Redirection strategies have been studied extensively and are widely used by CDNs today.

The interaction between network and content delivery has been studied both in systems and in theory research communities. Much prior research in this area has focused on two aspects, the interaction of overlay routing and network routing, and the interaction of request redirection and network routing. A key open question, that we address in this thesis, is how does the placement of content shape the interaction between network and content delivery, and how it affects the performance and cost metrics of networks and content delivery systems.

}
