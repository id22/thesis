\chapter{A Global Name Service for a Highly Mobile Internet}
\label{ch:auspice}
\vsp
\section{Introduction}
\vsp

``Mobile'' has long arrived, but the Internet remains unmoved. Today, there are almost 6 billion cellphones, over a billion of which are smartphones \cite{gartner}. The number of smartphones alone now exceeds the number of tethered hosts on the Internet, and recent studies \cite{cisco} suggests that the total data traffic generated by mobiles now exceeds that of tethered clients. However, the current Internet continues to operate as it did when dominated by tethered hosts, simply ignoring frequent endpoint mobility.

Today, one can not easily initiate communication with a smartphone (even when it has a public IP address) as there is no global infrastructure support for locating it. Applications like Netflix, Dropbox, or smartphone notification systems have to develop application-level support to enable a seamless experience for their users even as they change addresses several times a day, or let connections break (as popular VoIP apps do today).   The lack of intrinsic support for mobility means that developers are forced to redundantly develop and maintain common-case functionality. We are also paying an unknowable price in terms of long-term growth and innovation by forcing communication initiation to be unidirectional.

%The lack of intrinsic support for mobility means that we are paying an unknowable price in terms of stymied application innovation and growth by forcing developers to redundantly develop common-case functionality, and forcing communication initiation to be mostly unidirectional.

%A mobile user might reasonably expect that a voice-over-IP call she initiated through one WiFi network would continue uninterrupted if she switched to a different WiFi or  cellular network; or expect a file transfer she initiated at home on her laptop to resume when she opens it at work in a disruption-tolerant manner. Today, one can not easily initiate communication with a smartphone (even when it has a publicly visible IP address) because there is no global infrastructure support for locating it. Of course, application developers can design around these limitations, as do applications like Skype\tbd{I don't think Skype actually supports this today. Netflix maybe a better example.}, Dropbox, and smartphone notification systems respectively for the above scenarios. However, the lack of intrinsic support for mobility means that we are paying an unknowable price in terms of stymied application innovation and growth by forcing developers to redundantly develop common-case functionality, and forcing communication initiation to be mostly unidirectional.

%Many before us have criticized the Internet architecture's poor support not only for mobility but also for multihoming \cite{HIP,LISP,HAIR}, content retrieval \cite{DONA,LNA,CCN}, and security \cite{AIP,XIA,MobilityFirst-UMASS}. A common criticism is the Internet's so-called conflation of identity and location. The Internet uses an IP address both to represent the identity of an interface as well as its network location, which is problematic for mobility (same identity, changing locations) and multihoming (single identity, multiple locations) of devices, services, or content. Applications today are forced to know and care about changing IP addresses as the transport and network layers only provide a primitive to establish  connections between IP addresses, not application-friendly names. It is commonly accepted wisdom that a cleaner separation of identity and location is instrumental to fixing these problems.

%Many before us have criticized the Internet architecture's poor support not only for mobility but also for multihoming \cite{HIP,LISP,HAIR}, content retrieval \cite{DONA,LNA,CCN}, and security \cite{AIP,XIA,MobilityFirst}. A common criticism is the Internet's so-called conflation of identity and location. The Internet uses an IP address both to represent the identity of an interface as well as its network location, which is problematic for mobility (same identity, changing locations) and multihoming (single identity, multiple locations) of devices, services, or content. Applications today are forced to know and care about changing IP addresses as the transport and network layers only provide a primitive to establish  connections between IP addresses, not application-friendly names. It is commonly accepted wisdom that a cleaner separation of identity and location is instrumental to fixing these problems.

Many before us have criticized the Internet architecture's poor support for mobility as well as multihoming \cite{HIP,LISP,HAIR,MobilityFirst}. A common criticism is the Internet's so-called conflation of identity and location, i.e., the use of an IP address both to represent the identity of an interface as well as its network location, which is problematic for mobility (same identity, changing locations) and multihoming (single identity, multiple locations). It is commonly accepted wisdom that a cleaner separation of identity and location is instrumental to fixing these problems. However, the Internet does separate identities (domain-names) from network locations (IP addresses) through DNS. Most high-level programming languages also provide syntactic sugar to ``connect'' to names remaining oblivious to IP addresses; and %name owners can and do employ managed DNS services or CDNs to return the best-positioned network location corresponding to multi-homed names. 
techniques from a long line of work on connection migration can be employed to seamlessly handle mid-connection mobility.

But a key missing element from this package today is a distributed resolution infrastructure that can scale to orders of magnitude higher update rates than envisioned when DNS was created. To appreciate our envisioned scale, consider 10 billion mobile identifiers moving across a 100 different networks per day (or an aggregate rate of roughly 1M/sec). DNS's heavy reliance on TTL-based caching, a key strength recognized by its creators, researchers, and operators alike, also poses a significant handicap by increasing update propagation delays. It is not uncommon for DNS update propagation to take a day or more, resulting in long  outage times when online services have to be moved unexpectedly, prompting cries for help on operator forums \cite{serverfault}.

 %   Mobile has arrived, but the Internet is still static.

%    Reason 1: identity-location conflation. A number of solutions proposed to address this.

%    Reason 2: identity-location conflation would not be that problematic with an efficient resolution infrastructure. The Internet does separate human-readable ``names" from ``locations" or IP addresses through DNS. However, the design of the DNS resolution infrastructure implicitly assumes rare mobility. Indeed, Mockapetris and Dunlap allude to this by justifying the design decision of departing from the Xerox PARC Grapevine system... quote here.


Our position is that seamless support for mobility requires a global name service that rapidly translates identities to locations irrespective of how exactly identities and locations are individually represented. %In $\S$\ref{sec:bg}, we present a design space exploration comparing a number of classic and recent alternative architectures to argue that they all need or can significantly benefit from such a global name service to address the challenges posed by high mobility.
Our primary contribution is the design, implementation, and evaluation of \auspice, a distributed system that addresses this challenge. The key strength of \auspice\ is an placement engine  for replicating name records to achieve low lookup latency, low update cost, and high availability.  \auspice\ achieves low-latency by inferring pockets of high demand for a name so as to create replicas of resolvers for that name close to them. \auspice\ achieves low latency,  low update cost,  and high availability using a placement optimization algorithm that (1) controls the number of replicas based on the observed read and write rates, and (2) determines where to place replicas based both on the inferred pockets of demand and the aggregate load at node locations near those pockets. 



%As a proof of concept, we have also developed an accompanying user-level mobile socket library that allows endpoints to seamlessly migrate TCP connections.
We have implemented a prototype of \auspice\ as a geo-distributed key-value store to serve as a flexible name resolution infrastructure for the Internet as well as future Internet architecture proposals. We have deployed and evaluated it on several different platforms including Planetlab, a local cluster, and Amazon EC2.  Our contributions are as follows.
\begin{itemize}
\item A case for a global name resolution as an indispensable part of an Internetwork with intrinsic support for mobility.
\item \auspice, a massively scalable, geo-distributed, federatable global name service that significantly reduces the time-to-connect under resource constraints. 
%\auspice\ achieves lookup latencies comparable to leading managed DNS providers with only one-third as many replica locations, and provides a median update latency that is 1.0 s to 24.7 s lower.
%\item Proof-of-concept validation of end-to-end mobility and novel case-study apps leveraging \auspice's support for context-aware communication that generalizes address- or name-based communication. 
\item Evaluation against several leading commercial managed DNS services showing that \auspice\ achieves significantly lower time-to-connect and/or update cost in comparison.
%\emph{Mid-session mobility:} MSocket library enables seamless end-user mobility by migrating a TCP connection from Wi-Fi to 4G in three round trip times.
\end{itemize}

\eat{
\begin{itemize}
\item
\emph{Low response time:} Locality-aware placement helps \auspice\ achieve 5$\times$ lower median lookup latency than a DHT-based replication scheme.
\item
\emph{Capacity:} \auspice\  sustains  a maximum load that is 18$\times$ the maximum load sustained by a replicate-everywhere scheme, and is comparable to the maximum load sustained by DHT-based designs.
\item
\emph{Comparison to managed DNS:} \auspice\ achieves  DNS lookup latencies comparable to a leading managed DNS provider today even with only one third the locations of name resolvers. Median address update latencies for \auspice\  are 100 ms, 2 sec, and 30 sec lower than three managed DNS providers today.
\item
\emph{Support for mid-session mobility:} Fast address updates in \auspice\ enable seamless end-user mobility with connection reestablishments within a few hundred milliseconds.
\end{itemize}
}

\eat{
\emph{Low update cost:} \auspice\ reduces updates costs by nearly an order of magnitude over a replicate-everywhere strategy in a live deployment and yet achieves nearly identical lookup latencies.
\item
\emph{Load balance:} Over a wide range of loads, \auspice's achieves 2X - 4.5X lower lookup latencies over a random replication scheme, and  5.4X - 11.2X lower latency than a DHT-based replication scheme. Due to its lower update costs, \auspice\ can sustain 18$\times$ higher loads than a replicate everywhere strategy.
}

%\begin{itemize}
%\item
%Locality-aware placement helps \auspice\ achieve 5$\times$ lower median lookup latency than a DHT-based replication scheme. 
%\vspace{-0.1in}
%\item
%\auspice\ reduces updates costs by nearly an order of magnitude over a replicate-everywhere strategy in a live deployment and yet achieves nearly identical query latencies.\vspace{-0.1in}
%\item
%\auspice's load-aware design achieves 1.2$\times$-3.3$\times$ lower lookup latencies than a locality-unaware scheme over a wide range of load scenarios.\vspace{-0.1in}
%\item
%\auspice\ achieves  DNS lookup latencies comparable to a leading managed DNS provider today even with only one third the number of name resolvers.
%\end{itemize}

%\begin{enumerate}
%\item  \auspice's locality-aware and load-aware replication achieves  5$\times$ lower latency than Codons, a proposed DHT-based replication alternative to DNS.
%\item \auspice\ reduces update costs
%\end{enumerate}
\eat {

The Internet's tremendous success and our maturing realization of its shortcomings have attracted significant research attention towards a clean-slate redesign of the Internet's architecture (e.g., NSF FIND \cite{FIND}, GENI\cite{GENI}, FIA\cite{FIA}). A number of the shortcomings of the current Internet can be traced back to issues related to {\em naming}, a central component of any distributed system design. In the current Internet, network entities are identified using IP addresses and the Domain Name System (DNS) resolves human-readable end-host names to IP addresses. Although this design has proven to be surprisingly malleable, it suffers from two sets of fundamental problems, both of which are  exacerbated by the the exponential growth of mobile devices and applications today.


The first results from the conflation of identity and location within an IP address, a design decision roundly criticized by many \cite{ROFL,Saltzer:1993:NBN:RFC1498,HIP,FARA,LNAI}. Using an IP address to identify a network interface as well as the network location of that interface complicates {\em mobility}---when the location changes but not the identity---and {\em multihoming}---when a single identity simultaneously resides at multiple locations---e.g., being simultaneously connected to a cellular and WiFi access network. With roughly 5 billion mobile devices worldwide today \cite{gartner}  (over a billion of which are IP-capable) compared to barely a billion tethered hosts \cite{CIA}, mobility and multihoming are the norm, not an exception. Conflating identity and location also poses a serious but  less widely acknowledged security challenge, namely, verifying that an interface indeed has the identity it claims. Unlike human-readable names that are bound to public keys by trusted certification authorities in order to enable application-level authentication today, IP addresses are harder to certify, especially when they change many times a day. As a result, we largely make do today with application-level security over a network that can be easily rendered unavailable by spoofing or hijacking of IP addresses.



The second results from the architecture of DNS, a critical part of the Internet's core infrastructure. The design of DNS in the Internet's early days implicitly assumed tethered hosts or infrequently changing addresses to be the common case, an assumption evident in its heavy reliance on caching and timeout-based invalidations for scalability. An inevitable consequence of this design is that unanticipated updates to DNS resource records are slow; more than 40\% domain names have a TTL of a day or more \cite{codons}. Even for slow-changing records, DNS lookup times constitute a significant fraction of user-perceived response times, e.g., over 30\% of web objects incur a DNS lookup latency of over a second \cite{Jung,Huitema}. Deploying more passive local name sever caches can reduce lookup latencies, but this benefit comes at the cost of further increasing update propagation delays or update load in the system. These and other problems with DNS such as poor load balance and responsiveness to changing demand patterns, vulnerability to denial-of-service attacks, etc. have been well documented by researchers \cite{Pappas,codons,Brownlee,dnssec}.

Our primary contribution is the design and implementation of a global name service that addresses the above problems. This global name service is a central component of MobilityFirst, a clean-slate future Internet architecture that is primarily motivated by the dual concerns of {\em mobility} and {\em security}.
%two concerns that are remarkable both for their absence in the design philosophy underlying the current Internet \cite{Clark88} as well as their immense importance today. 
MobilityFirst cleanly separates identity and location using a {\em globally unique identifier} (GUID) that, unlike an IP address, is by design devoid of location or any other structured information. Information about a GUID's location or {\em network address} (NA) is maintained by the resolution service. Both GUID and NA are {\em self-certifying}, i.e., they are one-way hashes of public keys, allowing any network entity to authenticate an entity claiming to possess a GUID or NA. Thus, the structureless nature of these identifiers enhances mobility as well as security. Section \ref{sec:MF} describes how the name service helps efficiently support a number of other functions such as multihoming, incoming traffic engineering, content retrieval, network mobility, multicast, etc.

%Key feature: low response times while respecting capacity constraints and consistency requirements. TBD.

A critical distributed systems challenge in realizing a global name service that supports mobility at scale  is the design and implementation of the infrastructure that quickly resolves identifiers to network addresses. To appreciate the scale, consider 10 billion identifiers (for mobile devices, services, content identifiers, or entire networks such as vehicular networks) moving across a 100 network addresses per day, i.e., a load of a million/sec for updates alone. Furthermore, the name service should process lookup queries quickly, requiring queries to be directed to a nearby replica that holds a consistent replica of the corresponding resource records. Finally, the service should balance the aggregate load across all names across the geographically distributed locations of the global name service. 

Our proposed solution to achieving all of the goals above---low latency, low update cost, and load balance---is a placement engine \auspice, that {\underline{\bf au}}tomates {\underline{\bf s}}ervice {\underline{\bf p}}lacement {\underline{\bf i}}n {\underline{\bf e}}lastic {\underline{\bf c}}louds. The \auspice\ engine is flexible in that it enables automated placement for cloud-hosted services that are more general (and in widespread use today) than name resolvers in a future Internet architecture. To ensure low response times, \auspice\ dynamically spawns or migrates service replicas close to pockets of high demand. To ensure low update cost and load balance under capacity constraints, \auspice\ controls the number and placement of service replicas using heuristic algorithms that are uncoordinated across services or a global optimization algorithm coordinated across all services by the hosting service provider.

We comprehensively evaluate \auspice\ using an implemented prototype on Planetlab and Amazon EC2. Also design custom simulator. Validate simulator. Case studies and results preview. TBD.

\paragraph{Roadmap} The rest of this paper is organized as follows. Section \ref{sec:MF} presents the naming subsystem in the MobilityFirst Internet architecture. Section \ref{sec:auspice} presents the design goals and architecture of an automated service replica placement system, \auspice, for geo-distributed cloud-hosted services and the instantiation of a global name service using it. Section \ref{sec:eval} describes the datasets used and the experimental evaluation of \auspice. Section \ref{sec:related} describes related work and Section \ref{sec:concl} concludes.

}
